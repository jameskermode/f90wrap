# Third-party projects for f90wrap integration smoke tests.
#
# Notes:
# - Do not vendor third-party code in this repository.
# - The runner clones repos on demand and runs build/import/test commands.
#
# Keys:
#   repo: GitHub repository (owner/name)
#   branch: Branch to clone (optional, default: default branch)
#   build_cmd: Command to build/install the project (optional)
#   import_test: Python statement to import the built module/package (optional)
#   test_cmd: Command to run tests (optional)
#   enabled: false to skip by default (optional)
#   timeout: seconds (optional)
#   notes: free-form notes (optional)

projects:
  - repo: gvec-group/gvec
    branch: v1.3.0
    description: 3D MHD equilibrium solver (builds with f90wrap)
    build_cmd: pip install . --no-build-isolation
    import_test: "from gvec.lib import modgvec_py_state"
    enabled: true
    timeout: 1200

  - repo: itpplasma/SIMPLE
    branch: main
    description: Symplectic Integration for Particle Loss (uses f90wrap via cmake)
    build_cmd: pip install . --no-build-isolation
    import_test: "import pysimple"
    enabled: true
    timeout: 1200
    notes: main @ 42c15911a9c8b0d55b29c1f63a48f7ddfb1d8eb3

  # Smoke test: exercises f90wrap on inline selected_kind usage (issue #353).
  - repo: ecmwf-ifs/loki
    description: Fortran source-to-source translation (JIT uses f90wrap)
    build_cmd: pip install . --no-build-isolation
    import_test: "import loki"
    test_cmd: pytest -q loki/jit_build/tests/test_build.py::test_build_object
    enabled: true
    timeout: 900
    notes: Expected to fail on some f90wrap versions; keep as smoke test
